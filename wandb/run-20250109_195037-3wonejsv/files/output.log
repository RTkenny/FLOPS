init model
Training...
Epoch 1 started
train loss:0.7328217029571533; train accuracy 87.50%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:25<00:00, 36.77it/s]
Epoch 1, train loss: 0.7328217029571533, train acc: 87.50%, valid loss: 0.870161410522461, valid_acc: 78.03%, lr:0.001
Epoch 2 started
train loss:0.6965822577476501; train accuracy 74.48%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:23<00:00, 39.75it/s]
Epoch 2, train loss: 0.6965822577476501, train acc: 74.48%, valid loss: 0.5930736250877381, valid_acc: 82.39%, lr:0.00095
Epoch 3 started
train loss:0.44377732276916504; train accuracy 85.00%: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:24<00:00, 38.10it/s]
Epoch 3, train loss: 0.44377732276916504, train acc: 85.00%, valid loss: 0.5102317616939545, valid_acc: 84.59%, lr:0.00095
Epoch 4 started
train loss:0.5267858505249023; train accuracy 84.82%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:25<00:00, 37.50it/s]
Epoch 4, train loss: 0.5267858505249023, train acc: 84.82%, valid loss: 0.46974545345306395, valid_acc: 85.98%, lr:0.0009025
Epoch 5 started
train loss:0.48305633664131165; train accuracy 83.85%: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:26<00:00, 35.43it/s]
Epoch 5, train loss: nan, train acc: nan%, valid loss: 0.45929832539558413, valid_acc: 86.14%, lr:0.0009025
Epoch 6 started
train loss:0.22407153248786926; train accuracy 96.09%: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:24<00:00, 37.90it/s]
Epoch 6, train loss: 0.22407153248786926, train acc: 96.09%, valid loss: 0.445993119931221, valid_acc: 86.39%, lr:0.000857375
Epoch 7 started
train loss:0.47892266511917114; train accuracy 87.50%: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:26<00:00, 35.61it/s]
Epoch 7, train loss: 0.47892266511917114, train acc: 87.50%, valid loss: 0.4376506716489792, valid_acc: 86.80%, lr:0.000857375
Epoch 8 started
train loss:0.42855262756347656; train accuracy 85.16%: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:25<00:00, 36.23it/s]
Epoch 8, train loss: 0.42855262756347656, train acc: 85.16%, valid loss: 0.4237728885889053, valid_acc: 87.03%, lr:0.0008145062499999999
Epoch 9 started
train loss:0.5956088304519653; train accuracy 85.94%:  52%|███████████████████████████████████████████████████▏                                              | 490/938 [00:14<00:13, 33.83it/s]
Traceback (most recent call last):
  File "/nvme1/data_rt/LR/flops/train_mlp.py", line 68, in <module>
    trainer.train()
  File "/nvme1/data_rt/LR/flops/trainer_a.py", line 104, in train
    global_step = self.step(epoch, global_step)
  File "/nvme1/data_rt/LR/flops/trainer_a.py", line 204, in step
    loss, output = self.zo_step_all_params(self.model, data, target, self.sample_n)
  File "/nvme1/data_rt/LR/flops/trainer_a.py", line 348, in zo_step_all_params
    loss2, _ = self.zo_forward(model, data, target)
  File "/nvme1/data_rt/LR/flops/trainer_a.py", line 321, in zo_forward
    loss, output = self.compute_loss(model, data, target)
  File "/nvme1/data_rt/LR/flops/trainer_a.py", line 287, in compute_loss
    output, _ = model(data)
  File "/home/rt/data/miniconda3/envs/LR/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/rt/data/miniconda3/envs/LR/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nvme1/data_rt/LR/flops/models/my_mlp_modeling.py", line 39, in forward
    x = self.acti(self.fc1(x, add_noise=add_noise))
  File "/home/rt/data/miniconda3/envs/LR/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/rt/data/miniconda3/envs/LR/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nvme1/data_rt/LR/flops/models/modules.py", line 58, in forward
    logit_output = super().forward(input)
  File "/home/rt/data/miniconda3/envs/LR/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
